<!DOCTYPE html><html lang="en"><head><title>	Logscape 2.0 	</title><link href="css/bootstrap.min.css" rel="stylesheet"><link href="css/style.css" rel="stylesheet"><script src="js/bootstrap.min.js"></script><script src="js/jquery.js"></script></head><body><div class="container">		<div class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="nav-collapse collapse"><ul class="nav navbar-nav"><li class="active"> Main Support Site </li><li>Explore Logscape Apps </li><li> <a href="">Download </a></li></ul></div><h3>Logscape 2.0  </h3><a href="apps.html"> Applications   	|</a><a href="http://support.liquidlabs.co.uk"> Older Versions (1.3x)</a></div></div></div></body></html><!--<a href="monitoring-start.html">Monitoring Guide |  </a>--><div class="container-fluid"><p> </p><p> </p><br><br><br><p> </p><p> </p><div class="row"><div class="col-md-2 nav-padding"><p> <h3>Getting Started</h3></p><ul><li> <a href="index.html">Getting Started</a><ul><li><a href="searching-video.html">Quick Search Video</a></li><li> <a href="workspaces.html">Create a Workspace Video </a></li><li><a href="data-flow.html">Data Flow </a></li></ul></li><li>	<a href="searching-overview.html">	Search Overview</a><ul><li><a href="searching-cheatsheet.html">Cheat Sheet </a></li><li><a href="searching-functions.html">Function Index</a></li><li><a href="searching-heatmaps.html">Heatmaps</a></li><li><a href="searching-geoip.html">GeoIP </a></li></ul></li><li><a href="ds-add.html">How to add data </a><ul><li> <a href="ds-syslog.html">Syslog Devices </a></li></ul></li><li><a href="datatypes.html">Data Types  </a></li><li> <a href="deploy.html">How to deploy Apps</a></li><li><a href="ldap.html">LDAP</a></li><li><a href="alerting.html">Alerting  </a></li><li><a href="releasenotes.html">Release Notes </a></li></ul><p> 
Installation Guide </p><ul><li>	<a href="install-prerequisites.html">Prerequisites</a></li><li><a href="install-components.html">Components</a></li><li> <a href="install-manager.html">Manager Installation</a></li><li> <a href="install-forwarder.html">Install a Forwarder</a></li><li> <a href="install-indexer.html">Install an Indexer		</a></li><li>	<a href="install-updating.html">Updating Logscape </a></li></ul><p>	
Common Deployment Scenarios</p><ul><li><a href="using-forwarders.html">Default Scenario </a></li><li><a href="using-forwarders-failover.html">Forwarders + Failover </a></li><li><a href="using-indexstores.html">Multiple IndexStores + Failover</a></li><li><a href="using-indexstores-zones.html">Multiple IndexStores + Zones </a></li><li><a href="using-indexstores-zones-tenured.html">Multiple IndexStores + Zones + Tenured</a></li></ul><p> <a href="apps.html">Logscape Apps</a></p><ul><li> <a href="https://github.com/logscape/windowsapp#windowsapp-10">WindowsApp</a></li><li> <a href="https://github.com/logscape/unixapp#unixapp-10">UnixApp</a></li><li> <a href="https://github.com/logscape/coherenceapp#oraclecoherenceapp-10">Oracle Coherence App</a></li><li> <a href="https://github.com/logscape/javaapp#javaapp-10">JavaApp</a></li><li> <a href="https://github.com/logscape/ciscoapp#ciscoapp-10">Syslog Devices </a></li></ul><p> 
Contact</p><div><strong> <span>email: <a href="mailto:support@logscape.com">support@logscape.com</a></span></strong><br><strong><span>twitter: <a href="https://twitter.com/logscape">@logscape</a></span></strong></div></div><div class="col-md-10"><div class="image"><img src="images/searching-geoip.png"></div><h2>Configuring Your Datatype </h2><p>To use geoip lookups in your data, enable your datatype to perform the look up on particular fields. For instance, if I had data with the following structure</p><div class="image"><img src="images/searching-geoip-type.png"></div><p>My ip addresses are stored in the field clientIp.</p><div class="alert alert-info"><strong>Note:</strong>The map chart type expects the fields:<em>country&nbsp;</em>and/or<em>&nbsp;city </em>as field names in the data type for the visualization to work as expected </div><p>To perform the geo lookup you will need to use groovy synthetic function. The libraries are already included within logscape.</p><pre>geoipLookup.getLocation(clientip)</pre><p>This code will return a map containing the countryCode,city and longitude and latitude coordinates. </p><pre>	countryCode:"CN",
	city:"Beijing"
	lat:39.928894
	long;116.3883</pre><p>To pull out your countryCode, your synth will look something like this:</p><pre>groovy-script:
def loc = geoipLookup.getLocation(clientIp)
return loc.countryCode</pre><p>A more concise is only one line:</p><pre>groovy-script: geoipLookup.getLocation(clientIp).countryCode</pre><p>Save the type when you are done</p><h2>Visualisation</h2><p>The visualization is the easy part. Here is an example search</p><pre> 
 _tag.equals(www) country.count() chart(map)</pre><p>To include city level bubbles you would use the following search</p><pre>_tag.equals(www) country.count() city.count() chart(map)</pre><p>If you data type fields are not labelled country and city respectively you can alias them at search time. If my country data was stored in the field nation my search would look like this</p><pre>_tag.equals(www) nation.count(,country) chart(map)</pre><p>The second parameter to the count analytic is an alias for the field nation. </p></div></div></div><script src="js/ga.js"> </script>